local ffi = require("ffi")
local Texture = require("render.texture")
local smaa = {}

function smaa.GenerateSearchTexture()
	local width, height = 64, 16
	local data = ffi.new(
		"uint8_t[?]",
		width * height,
		{
			0xfe,
			0xfe,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0xfe,
			0xfe,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0xfe,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0xfe,
			0xfe,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0xfe,
			0xfe,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0xfe,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x7f,
			0x7f,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x7f,
			0x7f,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
			0x00,
		}
	)
	local tex = Texture.New(
		{
			width = width,
			height = height,
			format = "r8_unorm",
			buffer = data,
			sampler = {
				min_filter = "nearest",
				mag_filter = "nearest",
				wrap_s = "repeat",
				wrap_t = "repeat",
			},
		}
	)
	return tex
end

function smaa.GenerateAreaTexture()
	local width, height = 160, 560
	local data = ffi.new("uint8_t[?]", width * height * 2)

	-- Simplified AreaTex generation
	-- For now, fill with neutral values. Correct implementation requires complex integrals.
	for i = 0, width * height * 2 - 1 do
		data[i] = 0
	end

	local tex = Texture.New(
		{
			width = width,
			height = height,
			format = "r8g8_unorm",
			buffer = data,
			sampler = {
				min_filter = "linear",
				mag_filter = "linear",
				wrap_s = "repeat",
				wrap_t = "repeat",
			},
		}
	)
	return tex
end

return smaa
